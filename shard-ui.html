<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>O3 Shard Simulation GUI</title>
<style>
  body {
    font-family: monospace, monospace;
    background: #0b0c10;
    color: #66fcf1;
    margin: 20px;
  }
  h1 {
    text-align: center;
    margin-bottom: 1em;
  }
  #controls {
    text-align: center;
    margin-bottom: 1em;
  }
  button {
    background: #45a29e;
    border: none;
    color: #0b0c10;
    padding: 10px 15px;
    margin: 0 5px;
    font-weight: bold;
    cursor: pointer;
    border-radius: 4px;
  }
  button:hover {
    background: #66fcf1;
  }
  .shard-list {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    justify-content: center;
  }
  .shard {
    background: #1f2833;
    border: 2px solid #45a29e;
    border-radius: 8px;
    padding: 15px;
    width: 250px;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
  }
  .shard-header {
    font-weight: bold;
    font-size: 1.2em;
    margin-bottom: 10px;
    text-align: center;
  }
  .shard-status {
    margin-bottom: 10px;
  }
  .shard-buttons button {
    width: 100%;
    margin-bottom: 6px;
    font-weight: normal;
  }
  .energy-bar {
    height: 20px;
    background: #45a29e;
    border-radius: 10px;
    overflow: hidden;
    margin-bottom: 10px;
  }
  .energy-level {
    height: 100%;
    background: linear-gradient(90deg, #66fcf1, #45a29e);
    width: 0%;
    transition: width 0.3s ease;
  }
</style>
</head>
<body>

<a href="echojinx.html" style="color: #aa88ff; font-size: 1.2em; margin-bottom: 20px; display: inline-block;">‚Üê Back to EchoJinx</a>

<h1>O3 Shard Simulation GUI</h1>
<div id="controls">
  <button id="btn-create-shard">Create New Shard</button>
</div>
<div class="shard-list" id="shard-list"></div>

<script>
class O3Shard {
  constructor(id, onUpdate) {
    this.id = id;
    this.states = ['dormant', 'awakening', 'stabilizing', 'calibrating', 'activated'];
    this.stateIndex = 0; // dormant
    this.energyLevel = 0;
    this.awakenSequenceEngaged = false;
    this.interval = null;
    this.onUpdate = onUpdate; // callback to update UI
  }

  get state() {
    return this.states[this.stateIndex];
  }

  engageAwakenSequence() {
    if (this.awakenSequenceEngaged) return;
    if (this.state !== 'dormant') return;
    this.awakenSequenceEngaged = true;
    this.stateIndex = 1;
    this.energyLevel = 0;
    this.updateUI();
    this.processSequence();
  }

  processSequence() {
    this.interval = setInterval(() => {
      switch (this.state) {
        case 'awakening':
          this.energyLevel += 20;
          if (this.energyLevel >= 100) {
            this.energyLevel = 100;
            this.nextState();
          }
          this.updateUI();
          break;
        case 'stabilizing':
          this.nextState();
          this.updateUI();
          break;
        case 'calibrating':
          this.nextState();
          this.updateUI();
          break;
        case 'activated':
          this.awakenSequenceEngaged = false;
          clearInterval(this.interval);
          this.updateUI();
          break;
      }
    }, 1500);
  }

  nextState() {
    if (this.stateIndex < this.states.length - 1) {
      this.stateIndex++;
    }
  }

  pauseSequence() {
    if (this.interval) {
      clearInterval(this.interval);
      this.interval = null;
    }
    this.awakenSequenceEngaged = false;
    this.updateUI();
  }

  reset() {
    this.pauseSequence();
    this.stateIndex = 0;
    this.energyLevel = 0;
    this.updateUI();
  }

  updateUI() {
    if (typeof this.onUpdate === 'function') {
      this.onUpdate(this);
    }
  }
}

class ShardController {
  constructor(container) {
    this.shards = new Map();
    this.nextId = 1;
    this.container = container;
  }

  createShard() {
    const id = this.nextId++;
    const shard = new O3Shard(id, (shardInstance) => this.updateShardUI(shardInstance));
    this.shards.set(id, shard);
    this.addShardToDOM(shard);
  }

  addShardToDOM(shard) {
    const shardDiv = document.createElement('div');
    shardDiv.classList.add('shard');
    shardDiv.id = `shard-${shard.id}`;
    shardDiv.innerHTML = `
      <div class="shard-header">Shard #${shard.id}</div>
      <div class="shard-status">
        State: <span class="state">${shard.state}</span><br/>
        Energy: <span class="energy-text">${shard.energyLevel}%</span>
        <div class="energy-bar"><div class="energy-level" style="width: ${shard.energyLevel}%;"></div></div>
        Sequence: <span class="sequence">${shard.awakenSequenceEngaged ? 'Engaged' : 'Paused'}</span>
      </div>
      <div class="shard-buttons">
        <button class="engage">Engage</button>
        <button class="pause">Pause</button>
        <button class="reset">Reset</button>
      </div>
    `;
    this.container.appendChild(shardDiv);

    shardDiv.querySelector('.engage').addEventListener('click', () => {
      shard.engageAwakenSequence();
    });
    shardDiv.querySelector('.pause').addEventListener('click', () => {
      shard.pauseSequence();
    });
    shardDiv.querySelector('.reset').addEventListener('click', () => {
      shard.reset();
    });
  }

  updateShardUI(shard) {
    const shardDiv = document.getElementById(`shard-${shard.id}`);
    if (!shardDiv) return;
    shardDiv.querySelector('.state').textContent = shard.state;
    shardDiv.querySelector('.energy-text').textContent = `${shard.energyLevel}%`;
    shardDiv.querySelector('.energy-level').style.width = `${shard.energyLevel}%`;
    shardDiv.querySelector('.sequence').textContent = shard.awakenSequenceEngaged ? 'Engaged' : 'Paused';
    
    // Enable/disable buttons based on state
    shardDiv.querySelector('.engage').disabled = shard.awakenSequenceEngaged || shard.state !== 'dormant';
    shardDiv.querySelector('.pause').disabled = !shard.awakenSequenceEngaged;
  }
}

const shardList = document.getElementById('shard-list');
const controller = new ShardController(shardList);

document.getElementById('btn-create-shard').addEventListener('click', () => {
  controller.createShard();
});
</script>

</body>
</html>